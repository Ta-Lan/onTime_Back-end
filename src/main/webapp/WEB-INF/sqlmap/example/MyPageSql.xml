<?xml version="1.0" encoding="UTF-8"?>
        <!DOCTYPE mapper
                PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
                "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="mypage">

	<select id="getLastPayment" parameterType="map" resultType="Talan.DTO.PaymentDTO">
		SELECT PAYMENT_NUMBER, ESTIMATE_NUMBER 
		FROM (SELECT PAYMENT_NUMBER, ESTIMATE_NUMBER, ROWNUM 
			  FROM PAYMENT 
			  <if test="isPro == 0">
			  WHERE PEOPLE_ID = #{peopleId}
			  </if>
			  <if test="isPro == 1">
			  WHERE PRO_ID = #{peopleId}
			  </if>
			  ORDER BY PAYMENT_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>

	<select id="getLastEstimate" parameterType="map" resultType="String">
		SELECT ESTIMATE_TITLE 
		FROM (SELECT ESTIMATE_TITLE, ROWNUM 
			  FROM ESTIMATE 
			  WHERE PRO_ID = #{peopleId} 
			  ORDER BY ESTIMATE_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>

	<select id="getLastRequest" parameterType="map" resultType="String">
		SELECT REQUEST_TITLE 
		FROM (SELECT REQUEST_TITLE, ROWNUM 
			  FROM REQUEST 
			  WHERE PEOPLE_ID = #{peopleId} 
			  ORDER BY REQUEST_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>
	
	<select id="getLastReview" parameterType="map" resultType="String">
		SELECT REVIEW_TITLE  
		FROM (SELECT REVIEW_TITLE, ROWNUM 
			  FROM REVIEW
			  <if test="isPro == 0">
			  WHERE PEOPLE_ID = #{peopleId}
			  </if>
			  <if test="isPro == 1">
			  WHERE PRO_ID = #{peopleId}
			  </if>
			  ORDER BY REVIEW_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>
	
	<select id="getLastInquiry" parameterType="map" resultType="String">
		SELECT INQUIRY_TITLE  
		FROM (SELECT INQUIRY_TITLE, ROWNUM 
			  FROM INQUIRY 
			  WHERE PEOPLE_ID = #{peopleId}
			  ORDER BY INQUIRY_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>

	<select id="getLastReport" parameterType="map" resultType="String">
		SELECT REPORT_CONTENT  
		FROM (SELECT REPORT_CONTENT, ROWNUM 
			  FROM REPORT 
			  WHERE REPORT_PEOPLE = #{peopleId}
			  ORDER BY REPORT_NUMBER DESC) 
		WHERE ROWNUM = 1
	</select>


</mapper>